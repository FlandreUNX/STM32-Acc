/*
 * DTW.c
 *
 *  Created on: 17 de jan de 2017
 *      Author: Alan
 */

#include "DTW.h"

// Letter O (148)
//int16_t smooth2Ox[148] = {-43, -37, -45, -51, -38, -26, -16, -8, 3, 18, 31, 37, 41, 39, 41, 44, 39, 31, 21, 12, 0, -12, -7, -2, -3, -1, 0, -15, -42, -67, -81, -84, -84, -73, -57, -48, -42, -62, -82, -100, -109, -122, -129, -129, -116, -119, -98, -83, -63, -45, -33, -26, -11, -3, 0, -11, -11, -2, 1, 10, -3, -19, -17, -8, 18, 31, 39, 58, 66, 82, 112, 115, 128, 150, 149, 169, 202, 211, 213, 188, 171, 177, 186, 188, 203, 221, 229, 225, 195, 185, 212, 221, 226, 242, 255, 253, 254, 284, 313, 306, 267, 248, 226, 213, 199, 160, 135, 131, 150, 129, 110, 95, 68, 34, 17, 25, 30, 27, 24, 14, -8, -14, -13, -13, -3, 3, -6, -6, -10, -23, -45, -51, -56, -74, -91, -106, -104, -107, -97, -83, -68, -48, -27, -22, -14, -14, -20, -32};
//int16_t smooth2Oy[148] = {-965, -965, -963, -961, -958, -959, -959, -962, -962, -971, -980, -988, -989, -994, -1006, -1012, -1018, -1028, -1047, -1063, -1083, -1103, -1108, -1096, -1082, -1067, -1055, -1058, -1076, -1090, -1095, -1098, -1092, -1078, -1051, -1031, -1013, -1015, -1021, -1025, -1025, -1023, -1038, -1038, -1031, -1036, -1023, -1014, -1001, -986, -981, -978, -968, -947, -934, -923, -900, -883, -865, -859, -857, -865, -859, -850, -835, -824, -824, -836, -848, -851, -855, -852, -848, -829, -811, -777, -749, -757, -780, -800, -827, -848, -850, -858, -848, -837, -850, -861, -880, -879, -884, -883, -867, -873, -885, -885, -888, -908, -936, -960, -977, -984, -995, -998, -1003, -1016, -1028, -1036, -1023, -1053, -1068, -1078, -1099, -1129, -1135, -1113, -1078, -1068, -1064, -1055, -1067, -1074, -1079, -1078, -1065, -1046, -1040, -1039, -1021, -1012, -1018, -1012, -1001, -998, -1006, -1014, -1011, -1007, -1005, -988, -974, -956, -950, -950, -951, -952, -942, -958};
//int16_t smooth2Oz[148] = {226, 223, 222, 210, 218, 232, 233, 236, 249, 241, 247, 252, 257, 259, 252, 254, 262, 264, 265, 253, 255, 261, 276, 291, 286, 265, 235, 217, 225, 238, 253, 258, 261, 247, 224, 218, 205, 186, 170, 156, 144, 126, 91, 60, 33, 17, 26, 34, 38, 37, 44, 45, 49, 49, 37, 30, 17, -1, -16, -28, -46, -70, -85, -93, -87, -67, -41, -33, -25, -33, -40, -42, -31, -33, -25, -25, -55, -88, -99, -81, -70, -69, -82, -69, -29, 8, 32, 52, 78, 78, 54, 38, 26, 14, 0, -1, 10, 42, 86, 107, 80, 45, 40, 47, 38, 35, 29, 27, 39, 83, 131, 170, 173, 179, 174, 173, 170, 173, 178, 179, 191, 207, 232, 252, 268, 272, 273, 255, 231, 221, 228, 225, 228, 234, 234, 231, 234, 233, 234, 237, 238, 250, 258, 259, 266, 284, 286, 283};

//int16_t smooth8Ox[148] = {32, 29, 84, 84, 70, 89, 105, 126, 162, 207, 293, 372, 381, 394, 399, 412, 429, 411, 382, 346, 289, 272, 299, 346, 355, 357, 348, 350, 366, 404, 430, 418, 360, 371, 356, 320, 261, 174, 166, 120, 80, 89, 132, 139, 169, 165, 122, 47, -19, -60, -109, -117, -143, -186, -188, -176, -129, -92, -106, -111, -73, -87, -71, -41, -77, -46, -68, -37, -6, 51, 91, 127, 145, 193, 282, 345, 364, 364, 349, 345, 356, 383, 400, 396, 378, 331, 279, 199, 157, 158, 149, 158, 179, 166, 187, 198, 245, 339, 341, 246, 183, 194, 259, 258, 238, 204, 264, 333, 331, 260, 222, 166, 136, 173, 253, 288, 314, 280, 247, 277, 280, 284, 326, 320, 225, 137, 102, 139, 71, -33, -129, -106, -19, -5, -25, -53, -119, -176, -197, -196, -122, -39, 16, 12, 59, 84, 46, -47};
//int16_t smooth8Oy[148] = {-3710, -3714, -3720, -3727, -3710, -3684, -3653, -3663, -3694, -3706, -3722, -3700, -3715, -3704, -3724, -3706, -3687, -3701, -3770, -3831, -3905, -3934, -3915, -3872, -3875, -3908, -3974, -4037, -4104, -4151, -4165, -4183, -4252, -4311, -4363, -4364, -4353, -4414, -4460, -4461, -4438, -4401, -4332, -4251, -4141, -4044, -3948, -3864, -3824, -3805, -3747, -3672, -3630, -3669, -3665, -3641, -3559, -3520, -3476, -3483, -3466, -3458, -3407, -3385, -3427, -3397, -3348, -3293, -3278, -3276, -3278, -3309, -3357, -3390, -3360, -3286, -3319, -3400, -3453, -3459, -3442, -3397, -3383, -3397, -3407, -3407, -3431, -3499, -3538, -3568, -3570, -3554, -3537, -3540, -3570, -3538, -3486, -3527, -3536, -3539, -3525, -3570, -3576, -3652, -3745, -3859, -3869, -3888, -3914, -3973, -4022, -4050, -4024, -3982, -3880, -3812, -3800, -3872, -3953, -3902, -3897, -3849, -3807, -3848, -3961, -4073, -4144, -4100, -4106, -4205, -4264, -4144, -3980, -3917, -3931, -3960, -4002, -4117, -4203, -4232, -4176, -4147, -4108, -4078, -3976, -3884, -3825, -3800};
//int16_t smooth8Oz[148] = {1067, 1032, 997, 1003, 1008, 995, 972, 930, 903, 933, 985, 1055, 1123, 1128, 1095, 1087, 1084, 1092, 1080, 1071, 1102, 1113, 1121, 1128, 1108, 1090, 1054, 1009, 997, 1040, 1091, 1116, 1120, 1087, 1075, 1045, 970, 880, 827, 758, 697, 640, 610, 668, 725, 726, 673, 598, 529, 466, 440, 402, 328, 255, 197, 162, 109, 20, -75, -164, -212, -217, -187, -229, -236, -248, -223, -157, -92, -57, -35, -68, -47, -24, 6, 45, 17, -13, -59, -138, -225, -249, -240, -230, -195, -198, -171, -220, -264, -251, -242, -228, -236, -231, -231, -256, -234, -199, -171, -140, -41, 50, 12, -30, -33, -66, -45, 43, 157, 234, 265, 322, 377, 429, 434, 447, 501, 519, 567, 629, 675, 664, 624, 679, 738, 687, 630, 602, 668, 660, 617, 602, 659, 747, 697, 631, 658, 780, 823, 795, 838, 899, 948, 952, 974, 988, 943, 875};

//double smooth2Ox[148] = {-0.43, -0.37, -0.45, -0.51, -0.38, -0.26, -0.16, -0.08, 0.03, 0.18, 0.31, 0.37, 0.41, 0.39, 0.41, 0.44, 0.39, 0.31, 0.21, 0.12, 0.0, -0.12, -0.07, -0.02, -0.03, -0.01, 0.0, -0.15, -0.42, -0.67, -0.81, -0.84, -0.84, -0.73, -0.57, -0.48, -0.42, -0.62, -0.82, -1.0, -1.09, -1.22, -1.29, -1.29, -1.16, -1.19, -0.98, -0.83, -0.63, -0.45, -0.33, -0.26, -0.11, -0.03, 0.0, -0.11, -0.11, -0.02, 0.01, 0.1, -0.03, -0.19, -0.17, -0.08, 0.18, 0.31, 0.39, 0.58, 0.66, 0.82, 1.12, 1.15, 1.28, 1.5, 1.49, 1.69, 2.02, 2.11, 2.13, 1.88, 1.71, 1.77, 1.86, 1.88, 2.03, 2.21, 2.29, 2.25, 1.95, 1.85, 2.12, 2.21, 2.26, 2.42, 2.55, 2.53, 2.54, 2.84, 3.13, 3.06, 2.67, 2.48, 2.26, 2.13, 1.99, 1.6, 1.35, 1.31, 1.5, 1.29, 1.1, 0.95, 0.68, 0.34, 0.17, 0.25, 0.3, 0.27, 0.24, 0.14, -0.08, -0.14, -0.13, -0.13, -0.03, 0.03, -0.06, -0.06, -0.1, -0.23, -0.45, -0.51, -0.56, -0.74, -0.91, -1.06, -1.04, -1.07, -0.97, -0.83, -0.68, -0.48, -0.27, -0.22, -0.14, -0.14, -0.2, -0.32};
//double smooth2Oy[148] = {-9.65, -9.65, -9.63, -9.61, -9.58, -9.59, -9.59, -9.62, -9.62, -9.71, -9.8, -9.88, -9.89, -9.94, -10.06, -10.12, -10.18, -10.28, -10.47, -10.63, -10.83, -11.03, -11.08, -10.96, -10.82, -10.67, -10.55, -10.58, -10.76, -10.9, -10.95, -10.98, -10.92, -10.78, -10.51, -10.31, -10.13, -10.15, -10.21, -10.25, -10.25, -10.23, -10.38, -10.38, -10.31, -10.36, -10.23, -10.14, -10.01, -9.86, -9.81, -9.78, -9.68, -9.47, -9.34, -9.23, -9.0, -8.83, -8.65, -8.59, -8.57, -8.65, -8.59, -8.5, -8.35, -8.24, -8.24, -8.36, -8.48, -8.51, -8.55, -8.52, -8.48, -8.29, -8.11, -7.77, -7.49, -7.57, -7.8, -8.0, -8.27, -8.48, -8.5, -8.58, -8.48, -8.37, -8.5, -8.61, -8.8, -8.79, -8.84, -8.83, -8.67, -8.73, -8.85, -8.85, -8.88, -9.08, -9.36, -9.6, -9.77, -9.84, -9.95, -9.98, -10.03, -10.16, -10.28, -10.36, -10.23, -10.53, -10.68, -10.78, -10.99, -11.29, -11.35, -11.13, -10.78, -10.68, -10.64, -10.55, -10.67, -10.74, -10.79, -10.78, -10.65, -10.46, -10.4, -10.39, -10.21, -10.12, -10.18, -10.12, -10.01, -9.98, -10.06, -10.14, -10.11, -10.07, -10.05, -9.88, -9.74, -9.56, -9.5, -9.5, -9.51, -9.52, -9.42, -9.58};
//double smooth2Oz[148] = {2.26, 2.23, 2.22, 2.1, 2.18, 2.32, 2.33, 2.36, 2.49, 2.41, 2.47, 2.52, 2.57, 2.59, 2.52, 2.54, 2.62, 2.64, 2.65, 2.53, 2.55, 2.61, 2.76, 2.91, 2.86, 2.65, 2.35, 2.17, 2.25, 2.38, 2.53, 2.58, 2.61, 2.47, 2.24, 2.18, 2.05, 1.86, 1.7, 1.56, 1.44, 1.26, 0.91, 0.6, 0.33, 0.17, 0.26, 0.34, 0.38, 0.37, 0.44, 0.45, 0.49, 0.49, 0.37, 0.3, 0.17, -0.01, -0.16, -0.28, -0.46, -0.7, -0.85, -0.93, -0.87, -0.67, -0.41, -0.33, -0.25, -0.33, -0.4, -0.42, -0.31, -0.33, -0.25, -0.25, -0.55, -0.88, -0.99, -0.81, -0.7, -0.69, -0.82, -0.69, -0.29, 0.08, 0.32, 0.52, 0.78, 0.78, 0.54, 0.38, 0.26, 0.14, 0.0, -0.01, 0.1, 0.42, 0.86, 1.07, 0.8, 0.45, 0.4, 0.47, 0.38, 0.35, 0.29, 0.27, 0.39, 0.83, 1.31, 1.7, 1.73, 1.79, 1.74, 1.73, 1.7, 1.73, 1.78, 1.79, 1.91, 2.07, 2.32, 2.52, 2.68, 2.72, 2.73, 2.55, 2.31, 2.21, 2.28, 2.25, 2.28, 2.34, 2.34, 2.31, 2.34, 2.33, 2.34, 2.37, 2.38, 2.5, 2.58, 2.59, 2.66, 2.84, 2.86, 2.83};


// Letter L (148)
//int16_t smooth2Lx[148] = {18, 40, 37, 30, 30, 20, 17, 16, 10, 11, 17, 18, 18, 12, 8, 4, 11, 18, 6, 2, 8, 12, -1, -11, 0, 19, 18, 7, -5, -16, -10, -3, 5, 1, 2, 2, -13, -17, 7, 0, -4, 2, -13, -25, -27, -18, -27, -26, -21, -31, -36, -21, -15, -29, -35, -26, -22, -30, -32, -40, -53, -66, -75, -76, -75, -82, -73, -70, -73, -76, -72, -79, -68, -75, -96, -129, -162, -176, -174, -155, -127, -97, -85, -83, -83, -84, -91, -86, -93, -108, -123, -125, -131, -144, -136, -122, -112, -108, -119, -126, -119, -120, -115, -119, -101, -71, -50, -39, -37, -41, -41, -50, -54, -35, -20, -23, -35, -32, -35, -36, -12, 24, 42, 42, 45, 27, 14, 22, 26, 15, 0, 0, 9, 6, -10, -22, -23, -19, -20, -20, -21, -30, -33, -39, -39, -31, -27, -69};
//int16_t smooth2Ly[148] = {-980, -999, -988, -979, -980, -974, -966, -963, -958, -954, -955, -952, -953, -952, -949, -935, -914, -911, -915, -918, -924, -923, -921, -929, -927, -922, -922, -949, -973, -985, -990, -984, -962, -941, -944, -951, -942, -920, -905, -914, -917, -937, -964, -986, -996, -990, -986, -991, -993, -1001, -995, -980, -976, -984, -990, -982, -976, -972, -969, -975, -988, -989, -993, -994, -996, -1003, -1008, -991, -970, -959, -956, -970, -997, -1029, -1100, -1185, -1249, -1279, -1278, -1241, -1176, -1111, -1061, -1037, -1011, -994, -980, -973, -965, -967, -972, -980, -986, -983, -983, -982, -985, -984, -974, -983, -1001, -1014, -1007, -997, -981, -984, -997, -992, -986, -982, -973, -972, -976, -981, -990, -987, -988, -973, -958, -957, -966, -964, -981, -1002, -998, -1001, -1007, -1007, -997, -1002, -999, -1003, -995, -997, -1000, -993, -991, -985, -980, -970, -972, -985, -998, -1009, -1015, -1009, -996, -977};
//int16_t smooth2Lz[148] = {-89, -89, -90, -84, -83, -81, -83, -91, -91, -101, -92, -81, -81, -85, -83, -78, -63, -60, -70, -76, -83, -88, -83, -74, -65, -52, -65, -77, -91, -96, -81, -70, -56, -63, -72, -66, -63, -56, -46, -53, -66, -53, -52, -64, -70, -76, -67, -43, -40, -34, -14, -6, -3, -11, -10, -12, 10, 9, -3, -6, -2, 7, 25, 42, 49, 55, 51, 56, 76, 94, 108, 97, 102, 112, 110, 114, 97, 100, 100, 112, 111, 109, 111, 114, 110, 104, 100, 91, 93, 99, 108, 114, 110, 114, 102, 105, 108, 113, 115, 114, 97, 95, 96, 109, 107, 105, 115, 126, 132, 141, 141, 140, 119, 104, 114, 127, 127, 110, 93, 84, 78, 90, 110, 135, 149, 153, 151, 142, 125, 127, 136, 131, 140, 149, 160, 158, 146, 139, 127, 126, 123, 129, 129, 148, 171, 174, 182, 187};
//
//int16_t smooth8Lx[148] = {172, 191, 189, 251, 226, 155, 109, 58, 94, 128, 146, 142, 134, 115, 71, 70, 75, 84, 82, 120, 128, 171, 205, 200, 143, 170, 237, 216, 243, 225, 237, 170, 106, 115, 147, 105, 124, 102, 99, 134, 169, 107, 34, -1, 15, 30, 62, 86, 70, 36, -6, 5, -31, -67, 48, 156, 168, 117, 30, -47, -47, -78, -38, 59, 90, -14, -125, -224, -257, -246, -276, -267, -248, -237, -250, -298, -356, -387, -390, -366, -322, -331, -326, -316, -312, -300, -318, -329, -343, -343, -345, -288, -195, -88, 48, 184, 249, 326, 429, 473, 467, 380, 336, 259, 192, 161, 104, 59, 34, 21, 0, -19, -37, -64, -77, -88, -41, 14, 28, 7, 0, 7, 7, 47, 26, -42, -46, -35, -97, -84, -35, 0, 39, 48, 0, -39, -64, -63, -81, -99, -92, -56, -47, -43, -57, -53, -43, -40};
//int16_t smooth8Ly[148] = {-3825, -3823, -3803, -3803, -3778, -3802, -3801, -3790, -3740, -3702, -3685, -3657, -3650, -3640, -3681, -3642, -3608, -3538, -3490, -3454, -3437, -3382, -3390, -3461, -3530, -3541, -3490, -3514, -3540, -3575, -3650, -3724, -3739, -3731, -3700, -3676, -3669, -3667, -3593, -3538, -3525, -3554, -3611, -3700, -3748, -3792, -3842, -3914, -3915, -3926, -3972, -3977, -3975, -3945, -3833, -3741, -3747, -3781, -3835, -3889, -3884, -3841, -3813, -3784, -3909, -4116, -4343, -4539, -4587, -4560, -4480, -4365, -4248, -4145, -4100, -4043, -4011, -3926, -3860, -3794, -3733, -3687, -3640, -3648, -3659, -3674, -3672, -3667, -3682, -3721, -3721, -3700, -3660, -3650, -3638, -3607, -3611, -3649, -3680, -3700. -3706, -3717, -3709, -3724, -3721, -3705, -3722, -3731, -3699, -3657, -3659, -3692, -3687, -3696, -3735, -3758, -3740, -3681, -3637, -3627, -3651, -3667, -3699, -3656, -3608, -3630, -3670, -3730, -3778, -3776, -3721, -3710, -3623, -3689, -3710, -3724, -3703, -3678, -3701, -3700, -3669, -3662, -3651, -3648, -3660, -3671, -3667, -3678};
//int16_t smooth8Lz[148] = {-139, -108, -120, -129, -136, -129, -134, -104, -65, -82, -76, -60, -101, -150, -190, -214, -194, -135, -119, -146, -95, -41, -71, -110, -101, 22, 98, 120, 68, 32, -11, 55, 116, 169, 187, 165, 76, 49, 134, 188, 165, 186, 163, 150, 140, 246, 261, 297, 331, 403, 433, 440, 476, 538, 612, 730, 781, 772, 767, 772, 809, 903, 999, 1063, 1122, 1170, 1162, 1130, 1096, 1088, 1116, 1154, 1214, 1233, 1255, 1248, 1261, 1244, 1222, 1188, 1161, 1186, 1184, 1165, 1141, 1165, 1202, 1165, 1145, 1136, 1151, 1179, 1207, 1175, 1161, 1140, 1189, 1207, 1248, 1311, 1367, 1363, 1328, 1319, 1274, 1215, 1189, 1161, 1184, 1208, 1225, 1252, 1258, 1249, 1248, 1264, 1250, 1287, 1289, 1267, 1249, 1301, 1341, 1343, 1321, 1306, 1287, 1190, 1249, 1322, 1379, 1412, 1308, 1278, 1288, 1309, 1309, 1257, 1269, 1295, 1318, 1314, 1269, 1261, 1231, 1255, 1263, 1287};

//double smooth2Lx[148] = {0.18, 0.4, 0.37, 0.3, 0.3, 0.2, 0.17, 0.16, 0.1, 0.11, 0.17, 0.18, 0.18, 0.12, 0.08, 0.04, 0.11, 0.18, 0.06, 0.02, 0.08, 0.12, -0.01, -0.11, 0.0, 0.19, 0.18, 0.07, -0.05, -0.16, -0.1, -0.03, 0.05, 0.01, 0.02, 0.02, -0.13, -0.17, 0.07, 0.0, -0.04, 0.02, -0.13, -0.25, -0.27, -0.18, -0.27, -0.26, -0.21, -0.31, -0.36, -0.21, -0.15, -0.29, -0.35, -0.26, -0.22, -0.3, -0.32, -0.4, -0.53, -0.66, -0.75, -0.76, -0.75, -0.82, -0.73, -0.7, -0.73, -0.76, -0.72, -0.79, -0.68, -0.75, -0.96, -1.29, -1.62, -1.76, -1.74, -1.55, -1.27, -0.97, -0.85, -0.83, -0.83, -0.84, -0.91, -0.86, -0.93, -1.08, -1.23, -1.25, -1.31, -1.44, -1.36, -1.22, -1.12, -1.08, -1.19, -1.26, -1.19, -1.2, -1.15, -1.19, -1.01, -0.71, -0.5, -0.39, -0.37, -0.41, -0.41, -0.5, -0.54, -0.35, -0.2, -0.23, -0.35, -0.32, -0.35, -0.36, -0.12, 0.24, 0.42, 0.42, 0.45, 0.27, 0.14, 0.22, 0.26, 0.15, 0.0, 0.0, 0.09, 0.06, -0.1, -0.22, -0.23, -0.19, -0.2, -0.2, -0.21, -0.3, -0.33, -0.39, -0.39, -0.31, -0.27, -0.69};
//double smooth2Ly[148] = {-9.8, -9.99, -9.88, -9.79, -9.8, -9.74, -9.66, -9.63, -9.58, -9.54, -9.55, -9.52, -9.53, -9.52, -9.49, -9.35, -9.14, -9.11, -9.15, -9.18, -9.24, -9.23, -9.21, -9.29, -9.27, -9.22, -9.22, -9.49, -9.73, -9.85, -9.9, -9.84, -9.62, -9.41, -9.44, -9.51, -9.42, -9.2, -9.05, -9.14, -9.17, -9.37, -9.64, -9.86, -9.96, -9.9, -9.86, -9.91, -9.93, -10.01, -9.95, -9.8, -9.76, -9.84, -9.9, -9.82, -9.76, -9.72, -9.69, -9.75, -9.88, -9.89, -9.93, -9.94, -9.96, -10.03, -10.08, -9.91, -9.7, -9.59, -9.56, -9.7, -9.97, -10.29, -11.0, -11.85, -12.49, -12.79, -12.78, -12.41, -11.76, -11.11, -10.61, -10.37, -10.11, -9.94, -9.8, -9.73, -9.65, -9.67, -9.72, -9.8, -9.86, -9.83, -9.83, -9.82, -9.85, -9.84, -9.74, -9.83, -10.01, -10.14, -10.07, -9.97, -9.81, -9.84, -9.97, -9.92, -9.86, -9.82, -9.73, -9.72, -9.76, -9.81, -9.9, -9.87, -9.88, -9.73, -9.58, -9.57, -9.66, -9.64, -9.81, -10.02, -9.98, -10.01, -10.07, -10.07, -9.97, -10.02, -9.99, -10.03, -9.95, -9.97, -10.0, -9.93, -9.91, -9.85, -9.8, -9.7, -9.72, -9.85, -9.98, -10.09, -10.15, -10.09, -9.96, -9.77};
//double smooth2Lz[148] = {-0.89, -0.89, -0.9, -0.84, -0.83, -0.81, -0.83, -0.91, -0.91, -1.01, -0.92, -0.81, -0.81, -0.85, -0.83, -0.78, -0.63, -0.6, -0.7, -0.76, -0.83, -0.88, -0.83, -0.74, -0.65, -0.52, -0.65, -0.77, -0.91, -0.96, -0.81, -0.7, -0.56, -0.63, -0.72, -0.66, -0.63, -0.56, -0.46, -0.53, -0.66, -0.53, -0.52, -0.64, -0.7, -0.76, -0.67, -0.43, -0.4, -0.34, -0.14, -0.06, -0.03, -0.11, -0.1, -0.12, 0.1, 0.09, -0.03, -0.06, -0.02, 0.07, 0.25, 0.42, 0.49, 0.55, 0.51, 0.56, 0.76, 0.94, 1.08, 0.97, 1.02, 1.12, 1.1, 1.14, 0.97, 1.0, 1.0, 1.12, 1.11, 1.09, 1.11, 1.14, 1.1, 1.04, 1.0, 0.91, 0.93, 0.99, 1.08, 1.14, 1.1, 1.14, 1.02, 1.05, 1.08, 1.13, 1.15, 1.14, 0.97, 0.95, 0.96, 1.09, 1.07, 1.05, 1.15, 1.26, 1.32, 1.41, 1.41, 1.4, 1.19, 1.04, 1.14, 1.27, 1.27, 1.1, 0.93, 0.84, 0.78, 0.9, 1.1, 1.35, 1.49, 1.53, 1.51, 1.42, 1.25, 1.27, 1.36, 1.31, 1.4, 1.49, 1.6, 1.58, 1.46, 1.39, 1.27, 1.26, 1.23, 1.29, 1.29, 1.48, 1.71, 1.74, 1.82, 1.87};

void printArray(double *array, int size) {
    int i;
    for (i = 0; i < size; i++) {
        printf("%lf, ", array[i]);
    }
}

void printMatrix(double *matrix, int rows, int columns) {
    int i, j;
    for (i = 0; i < rows; i++) {
        for (j = 0; j < columns; j++) {
            printf("%.2lf ", *(matrix + (i * columns) + j));
        }
        printf("\n");
    }
}

double average(double *array, int begin, int end) {
    double sum = 0;
    int i;
    for(i = begin; i < end; i++) {
        sum += array[i];
    }
    return sum / (double) end - begin;
}

int16_t min(int16_t a, int16_t b, int16_t c) {
    if(a < b) {
        return a < c ? a : c;
    }
    return b < c ? b : c;
}

void ewma(double *array, int size, double *result) {

    int s = size < 6 ? size : 6;
    double forecasted = average(array, 0, s);
    double smoothed = 0;

    int i;

    for (i = 1; i <= size; i++) {
        smoothed = EWMA_ALPHA * array[i - 1] + (1.0 - EWMA_ALPHA) * forecasted;
        forecasted = smoothed;
        result[i - 1] = smoothed;
    }

}

double dtwDistance(double *ax, double *ay, double *az, int sa, double *bx, double *by, double *bz, int sb) {

	float acc[sb][sa];
	float dist;

	acc[0][0] = pow(ax[0] - bx[0], 2.0) + pow(ay[0] - by[0], 2.0) + pow(az[0] - bz[0], 2.0);

    // Accumulated distance - Row 0
    for (int i = 1; i < sa; i++) {
        dist = pow(ax[i] - bx[0], 2.0) + pow(ay[i] - by[0], 2.0) + pow(az[i] - bz[0], 2.0);
        acc[0][i] = acc[0][i - 1] + dist;
    }

    // Accumulated distance - Row 0
    for (int i = 1; i < sb; i++) {
        dist = pow(ax[0] - bx[i], 2.0) + pow(ay[0] - by[i], 2.0) + pow(az[0] - bz[i], 2.0);
        acc[i][0] = acc[i - 1][0] + dist;
    }

    // Accumulated distance - Remaining
    double m;
    for (int i = 1; i < sb; i++) {
        for (int j = 1; j < sa; j++) {
            dist = pow(ax[j] - bx[i], 2.0) + pow(ay[j] - by[i], 2.0) + pow(az[j] - bz[i], 2.0);
            m = min(acc[i - 1][j - 1],
                    acc[i - 1][j],
                    acc[i][j - 1]);
            acc[i][j] = m + dist;
        }
    }

    return sqrt(acc[sb - 1][sa - 1]);

}

int knn(int16_t inputX[], int16_t inputY[], int16_t inputZ[], int size) {
//	double distanceO = dtwDistance(smooth2Ox, smooth2Oy, smooth2Oz, 148, inputX, inputY, inputZ, size);
//	double distanceL = dtwDistance(smooth2Lx, smooth2Ly, smooth2Lz, 148, inputX, inputY, inputZ, size);
//    return distanceO < distanceL ? 0 : 1;
	return 0;
}
