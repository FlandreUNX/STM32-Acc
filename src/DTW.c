/*
 * DTW.c
 *
 *  Created on: 17 de jan de 2017
 *      Author: Alan
 */

#include "DTW.h"

// Slow O
float slowOx[197] = {-0.300833344, -0.321583331, -0.297108322, -0.312975824, -0.249083072, -0.201358154, -0.200950712, -0.137665495, -0.150365844, -0.129256085, -0.171479255, -0.240035474, -0.294024825, -0.400817364, -0.472572148, -0.495800495, -0.518060327, -0.560642242, -0.512449563, -0.544714689, -0.516300261, -0.511410177, -0.507987142, -0.511591017, -0.514113724, -0.503879607, -0.421715736, -0.373201013, -0.417240709, -0.436068505, -0.461247951, -0.400873572, -0.355611503, -0.356928051, -0.342849642, -0.350994766, -0.338696331, -0.309087425, -0.246361196, -0.238452837, -0.256917, -0.284841895, -0.295389324, -0.245772526, -0.214040771, -0.191828534, -0.233279973, -0.199295983, -0.163507193, -0.114455037, -0.080118522, -0.0830829665, -0.0851580799, -0.0596106574, -0.0867274627, -0.111709222, -0.12319646, -0.0892375186, -0.0624662638, -0.0467263833, 0.0212915335, 0.0029040738, 0.026032852, 0.111222997, 0.140856102, 0.152599275, 0.166819498, 0.170773655, 0.131541565, 0.0440790951, 0.0188553669, 0.0221987572, 0.0155391302, 0.0228773914, -0.0319858268, -0.0223900788, -0.000673054892, 0.0175288618, -0.0537297949, -0.0166108571, -0.0296275988, -0.0177393183, -0.0664175227, -0.0284922663, 0.031055415, 0.0757387951, 0.0710171536, 0.0407120064, 0.0674984008, 0.122248881, 0.178574219, 0.113001958, 0.0311013721, -0.0382290408, -0.011760328, 0.00676777074, 0.00173743954, 0.00121620763, -0.0441486575, -0.0219040606, -0.00633284263, -0.0284329895, -0.115903087, -0.108132161, -0.171692505, -0.22818476, -0.26172933, -0.291210532, -0.305847377, -0.262093157, -0.20446521, -0.131125644, -0.0767879486, -0.0417515635, -0.0442260951, -0.0849582702, -0.0594707876, -0.101629555, -0.116140693, -0.102298483, -0.0986089408, -0.117026255, -0.0429183803, 0.0569571331, 0.0818699896, 0.123308994, 0.0323162936, -0.0223785955, -0.0366650186, -0.0796655118, -0.085765861, -0.105036102, -0.106525272, -0.137567684, -0.0812973753, -0.026908163, 0.050164286, 0.0171150006, -0.0150195006, -0.0525136515, -0.147759557, -0.127431691, -0.149202183, -0.215441525, -0.255809069, -0.278066337, -0.230646431, -0.212452501, -0.145716757, -0.162001729, -0.167401209, -0.135180846, -0.0976265892, -0.131338611, -0.202937037, -0.214055926, -0.296839148, -0.321787417, -0.222251192, -0.152575836, -0.148803085, -0.155162156, -0.102613509, -0.0838294551, -0.0616806187, -0.0971764326, -0.0560235046, -0.0872164518, -0.100051515, -0.136036053, -0.143225238, -0.115257666, -0.128680363, -0.114076257, -0.190853387, -0.250597358, -0.334418148, -0.321092695, -0.278764904, -0.183135435, -0.125194803, -0.138636366, -0.058045458, 0.00136817957, 0.0249577258, 0.155470416, 0.213829294, 0.179680511, 0.116776355, 0.132743448, 0.137920409, 0.0875442848, 0.0432810001, 0.0752967, 0.0887076855, 0.203095376, 0.211166769};
float slowOy[197] = {-9.54299927, -9.56309891, -9.53216934, -9.57051849, -9.6093626, -9.5795536, -9.61568737, -9.67998123, -9.68898678, -9.68329048, -9.77230358, -9.81061268, -9.90642929, -9.92550087, -9.93285084, -9.9529953, -9.98209667, -9.99646759, -9.93152714, -9.8890686, -9.85634804, -9.82444382, -9.84411049, -9.85787773, -9.85851479, -9.78996086, -9.81097221, -9.83768082, -9.838377, -9.83886433, -9.84520531, -9.85264397, -9.85485077, -9.85939598, -9.85357761, -9.83750439, -9.85625267, -9.8753767, -9.87676334, -9.9167347, -9.92371368, -9.99459934, -10.0232201, -10.055254, -10.0566778, -10.1296749, -10.1777725, -10.166441, -10.0865088, -10.0275564, -9.90828991, -9.88180256, -9.8542614, -9.7899828, -9.75098801, -9.71469116, -9.75828362, -9.78279877, -9.81495953, -9.80447197, -9.81813049, -9.87269115, -9.83588409, -9.7831192, -9.80618286, -9.76532841, -9.7277298, -9.75841045, -9.7798872, -9.77092075, -9.77364445, -9.80255127, -9.81378555, -9.82765007, -9.75935555, -9.80154896, -9.79208469, -9.74045944, -9.77632141, -9.76542473, -9.73079681, -9.74255753, -9.7717905, -9.79225349, -9.75257778, -9.70680428, -9.75276279, -9.79093361, -9.78765297, -9.80635738, -9.83145046, -9.82201576, -9.88741112, -9.89718819, -9.87403202, -9.85482216, -9.85337543, -9.84936333, -9.8975544, -9.82328796, -9.75030136, -9.66321087, -9.65024757, -9.67417336, -9.66692162, -9.66484547, -9.68739128, -9.6731739, -9.66622162, -9.68835545, -9.70384884, -9.70869446, -9.69408607, -9.66886044, -9.66020203, -9.72314167, -9.72819901, -9.70173931, -9.70421791, -9.63095284, -9.57666683, -9.57466698, -9.50126648, -9.46788692, -9.47452068, -9.47316456, -9.53821468, -9.58675003, -9.59072495, -9.66850758, -9.71095562, -9.8126688, -9.8238678, -9.7777071, -9.7963953, -9.8244772, -9.79013443, -9.84109402, -9.95776558, -10.0634365, -10.1794052, -10.2275839, -10.2193089, -10.2045164, -10.1221619, -10.0345135, -9.96115971, -9.90681171, -9.9437685, -9.93363762, -9.96854591, -9.92098236, -9.82468796, -9.82028198, -9.87419701, -9.85493851, -9.89245701, -9.81371975, -9.71060371, -9.63542271, -9.66379547, -9.73165703, -9.77915955, -9.70741177, -9.60018826, -9.61513138, -9.65859222, -9.64701462, -9.69890976, -9.72623634, -9.70636559, -9.65045643, -9.67731953, -9.72312355, -9.78518677, -9.95463085, -10.0522413, -10.1025686, -10.0777979, -9.98245811, -9.96372032, -10.0196037, -9.90872288, -9.85510635, -9.79957485, -9.75770187, -9.73739147, -9.64817429, -9.60972214, -9.56780529, -9.59246349, -9.72672462, -9.80570698, -9.8639946, -9.84479618, -9.80735779, -9.77815056};
float slowOz[197] = {2.42616653, 2.38231659, 2.37862158, 2.46603513, 2.51222467, 2.52955723, 2.56269002, 2.4778831, 2.44851828, 2.43996286, 2.39197397, 2.38238168, 2.33066726, 2.33046699, 2.30332685, 2.19732881, 2.24013019, 2.22509122, 2.25956392, 2.2236948, 2.19858646, 2.20201063, 2.23440742, 2.22708511, 2.30895948, 2.23727155, 2.27709007, 2.23596311, 2.1441741, 2.13692188, 2.08984542, 2.06889176, 2.10222435, 2.13155699, 2.18508983, 2.27056289, 2.23439407, 2.10707593, 2.00895309, 2.11126709, 2.11388683, 2.07372069, 2.05760455, 2.03732324, 2.07712626, 1.99098837, 1.98469186, 1.99828434, 1.94479907, 1.97035933, 1.89225149, 1.82557607, 1.84790325, 1.86053228, 1.83337259, 1.84736085, 1.73415256, 1.65790677, 1.71553469, 1.77987432, 1.746912, 1.69083834, 1.62458682, 1.65321076, 1.61324751, 1.64527321, 1.54769123, 1.54838383, 1.5038687, 1.48770809, 1.43739569, 1.41717696, 1.3940239, 1.32681668, 1.25877166, 1.22014022, 1.22309816, 1.21616876, 1.25631809, 1.23642266, 1.16549587, 1.16084707, 1.19659293, 1.23361504, 1.21753049, 1.20327139, 1.19028997, 1.25920296, 1.19944203, 1.19060946, 1.18442655, 1.24609852, 1.23226893, 1.23758829, 1.19631183, 1.19441831, 1.20209289, 1.19246507, 1.15272558, 1.11890793, 1.03823555, 0.939764857, 0.837835431, 0.826484799, 0.803539336, 0.814477503, 0.83113426, 0.824793994, 0.790355802, 0.733249068, 0.732274354, 0.776592016, 0.849614382, 0.870730042, 0.864511013, 0.821157694, 0.811810374, 0.742267251, 0.672587097, 0.668810964, 0.741167665, 0.863817334, 0.916672111, 0.911670446, 0.908169329, 0.89071852, 0.875502944, 0.876852036, 0.898796439, 0.845157504, 0.873610258, 0.884527206, 0.784169018, 0.827918291, 0.80454278, 0.893179953, 1.00922596, 0.97045815, 1.03332067, 1.18232441, 1.39462709, 1.41723895, 1.40006733, 1.32504714, 1.27553296, 1.25287306, 1.34801114, 1.35460782, 1.43722546, 1.53105783, 1.62374043, 1.67961824, 1.73373282, 1.82561302, 1.82092905, 1.87465036, 1.79825521, 1.70877862, 1.72414505, 1.74390149, 1.82673109, 1.86971176, 1.89379823, 1.94365871, 1.94556117, 2.06989288, 2.08192492, 2.16234732, 2.20964313, 2.25475025, 2.31632519, 2.36542773, 2.36679935, 2.3587594, 2.3291316, 2.37739205, 2.45917439, 2.44442201, 2.47909546, 2.59636688, 2.65745687, 2.66421986, 2.6899538, 2.77696776, 2.81687737, 2.82681417, 2.82776999, 2.86143899, 2.87900734, 2.8223052, 2.78861356, 2.72902942, 2.76832056, 2.91282439, 3.01097703, 3.07968402, 3.18177891};

// Normal O
float normalOx[100] = {0.266833335, 0.375783324, 0.515048325, 0.444533825, 0.260173678, 0.137121573, 0.143985093, 0.139789566, 0.250852704, 0.397596896, 0.677317858, 1.08612251, 1.3662858, 1.3914001, 1.27398002, 1.24878597, 1.14415014, 0.929905117, 0.64193356, 0.545353472, 0.525747418, 0.410023183, 0.218016222, -0.135388643, -0.457772076, -0.683440447, -0.838408351, -0.943885863, -1.16772008, -1.45340407, -1.65338278, -1.88336802, -2.02635765, -2.17145038, -2.13201523, -1.99941063, -1.90358746, -1.6925112, -1.5387578, -1.50313044, -1.32519126, -1.26063395, -1.15544379, -1.12381065, -0.996667445, -0.769667208, -0.553767025, -0.435636908, -0.36794582, -0.152562082, 0.127206534, 0.203044578, 0.292131215, 0.492491841, 0.644744277, 0.778321028, 0.901824713, 1.11427736, 1.34999418, 1.53299594, 1.82309711, 1.993168, 2.13321757, 2.12325239, 1.8882767, 1.6997937, 1.63385558, 1.83369887, 1.98558915, 1.94191241, 1.80633867, 1.59743702, 1.35520589, 1.19764411, 1.21635091, 1.37944567, 1.49661195, 1.46762836, 1.40833986, 1.50483787, 1.47938645, 1.38657045, 1.36659932, 1.41561949, 1.43793368, 1.42655361, 1.14258754, 0.928811312, 0.974167943, 1.02691758, 1.12684226, 1.01678956, 0.930752695, 0.888526917, 0.74196887, 0.675378203, 0.610764742, 0.0375353321, -0.432725251, -0.857907653};
float normalOy[100] = {-9.89233303, -9.87063313, -9.85844326, -9.94890976, -10.0242367, -10.0049658, -10.0484762, -10.0459337, -10.0351534, -10.0546074, -10.1402254, -10.2391577, -10.2814102, -10.3229876, -10.3460913, -10.5032635, -10.7032843, -10.9062986, -11.0904093, -11.2222862, -11.1676006, -10.9943209, -10.9420242, -10.9294167, -10.9355917, -10.8139143, -10.7017403, -10.6292181, -10.5544529, -10.4631166, -10.3961811, -10.3973265, -10.3531284, -10.4241896, -10.3299322, -10.2009525, -10.1616669, -10.0681667, -9.96971703, -9.91880226, -9.74216175, -9.67251301, -9.67175865, -9.51523113, -9.38166142, -9.15316296, -8.94521427, -8.71565056, -8.45595551, -8.20216846, -8.16851807, -8.21396255, -8.13177395, -8.10724163, -8.22506905, -8.34954834, -8.27468395, -8.12027931, -8.04819584, -8.1297369, -8.08481598, -8.03837109, -8.12885952, -8.29120159, -8.46784115, -8.4894886, -8.38464165, -8.25724888, -8.36907387, -8.47735119, -8.70614624, -8.96830273, -9.21481228, -9.39336872, -9.51835823, -9.58185101, -9.65929604, -9.8395071, -10.1126547, -10.2318583, -10.4533005, -10.67731, -10.768117, -10.564682, -10.3412771, -10.2238941, -10.477726, -10.6524086, -10.6606865, -10.6514807, -10.6180363, -10.8556252, -11.0819378, -11.2043562, -11.3650494, -11.3545341, -11.1071739, -11.0810223, -10.9307156, -10.7805014};
float normalOz[100] = {1.10133338, 1.04393339, 1.06075335, 1.20452738, 1.20916915, 1.27241838, 1.32569289, 1.33898497, 1.33028948, 1.40520263, 1.40664184, 1.41964936, 1.4677546, 1.59442818, 1.59309971, 1.45116985, 1.36081886, 1.42057323, 1.30340123, 1.37738085, 1.32716656, 1.33101654, 1.23771155, 0.899398088, 0.79157865, 0.884105086, 0.927873552, 1.05451155, 1.00515807, 0.859610617, 0.658727407, 0.320109189, -0.0399235673, -0.192946494, -0.22806254, -0.393643767, -0.42555064, -0.546885431, -0.667819798, -0.584473848, -0.589131713, -0.670392215, -0.637274563, -0.824092209, -0.903864563, -1.01370513, -1.08159363, -1.05711555, -1.14498091, -1.15248656, -1.10374057, -1.03061843, -0.979432881, -0.934603035, -0.951222122, -1.04085553, -1.04659891, -1.11961925, -1.1947335, -1.1993134, -1.08851933, -0.776963532, -0.594874501, -0.584412158, -0.760088503, -0.721061945, -0.534743369, -0.338320345, -0.116824239, -0.01877697, -0.03414388, 0.0150992824, 0.247569501, 0.602298617, 0.907609046, 0.785326362, 0.549728453, 0.339809924, 0.24386695, 0.329706848, 0.599794805, 0.812856317, 0.988999426, 1.01329958, 0.865309715, 0.707716823, 0.768401802, 0.97888124, 1.14121687, 1.28185177, 1.37729621, 1.4621073, 1.51847506, 1.65993249, 1.7019527, 1.82736683, 1.80415678, 1.8659097, 1.81913686, 1.68139577};

// Fast O
float fastOx[35] = {2.0855, 1.54384995, 1.31169498, 1.75218654, 3.24253058, 5.20677137, 6.50373983, 6.20261765, 4.10483217, 0.773382545, -2.36863208, -4.61004257, -5.46202993, -5.84542084, -6.43179464, -7.37325621, -7.62127924, -7.14989567, -6.13292694, -4.87204885, -3.48243427, -1.85570395, -0.119992748, 2.07000494, 3.9630034, 5.15610218, 6.22827148, 7.00578976, 7.02205276, 6.42743683, 5.25220585, 3.33454418, 1.10418093, -0.949073255, -2.28435135};
float fastOy[35] = {-10.0168333, -9.82578373, -9.50904846, -9.39233398, -9.89863396, -11.2280436, -13.709631, -15.4917412, -16.7392197, -17.6124535, -18.1697178, -16.6938019, -14.3676615, -11.4793625, -9.22355366, -7.85148764, -6.3000412, -4.48202896, -2.8134203, -1.4053942, -0.314775944, 0.502656877, 0.99985981, 0.465901881, -0.59486866, -2.555408, -4.60578585, -6.86605024, -9.909235, -12.8314648, -14.8770256, -16.308918, -17.3112431, -17.6678696, -16.2615089};
float fastOz[35] = {1.15483332, 0.808383346, 0.38286835, 0.553007841, 0.984105468, 2.53087378, 4.60961151, 6.4907279, 7.2195096, 5.96565676, 3.50095963, 1.11867177, -0.317929775, -1.45855081, -2.16398549, -2.11478996, -1.72035301, -1.2522471, -1.11657298, -1.08760107, -0.980320752, -0.602224529, 0.346442819, 1.43950999, 2.19265699, 2.88786006, 3.55750203, 4.02325153, 4.33127594, 4.40889311, 3.8452251, 2.75165749, 1.70116019, 0.620812118, -0.240431517};

// Slow Z
float slowZx[144] = {-0.517500043, -0.458250016, -0.455775023, -0.481042534, -0.519729793, -0.582810879, -0.686967611, -0.69687736, -0.811814189, -0.907269955, -1.02508891, -1.10456228, -1.1481936, -1.15773547, -1.22741485, -1.26419044, -1.29893327, -1.32925332, -1.28147733, -1.20603418, -1.1742239, -1.1549567, -1.07846963, -1.03392875, -0.990750134, -0.969525099, -0.924667537, -0.88126725, -0.892887056, -0.796020925, -0.743214667, -0.700250268, -0.733175159, -0.756222606, -0.70635581, -0.695449054, -0.693814337, -0.782670021, -0.826869011, -0.860808313, -0.824565828, -0.70619607, -0.542337239, -0.277636051, -0.0173452441, 0.254858315, 0.643400788, 0.969380558, 1.20656633, 1.3065964, 1.22361743, 1.10553217, 0.950872481, 0.809610724, 0.674727499, 0.562309265, 0.384616494, 0.269231558, 0.0834620893, -0.0555765368, -0.0389035754, -0.0902324989, -0.192162752, -0.293513924, -0.394459754, -0.516121805, -0.643285275, -0.681299686, -0.707909763, -0.774536848, -0.818175793, -0.73172307, -0.746206164, -0.792344332, -0.82764101, -0.924348712, -1.10004413, -1.19003093, -0.995021641, -0.774515152, -0.848160625, -1.00171244, -0.899198711, -0.716439068, -0.720507383, -0.76535517, -0.745748639, -0.894024074, -1.01581681, -0.942071736, -0.866450191, -0.98151511, -1.00806057, -0.879642367, -0.840749681, -0.933524787, -0.980467379, -0.938327134, -1.06482899, -1.40538025, -1.63476622, -1.6813364, -1.69293547, -1.6140548, -1.56783843, -1.71548688, -1.85184085, -1.8572886, -1.75310206, -1.63517141, -1.49562001, -1.454934, -1.48345375, -1.51241767, -1.49069238, -1.46648467, -1.33853924, -1.30897748, -1.29728425, -1.29809892, -1.26266921, -1.22586846, -1.12210798, -1.01047564, -0.917332947, -0.840133071, -0.71709317, -0.62196523, -0.576375663, -0.532462955, -0.546724081, -0.640706837, -0.727494776, -0.629246354, -0.476472437, -0.324530721, -0.257171512, -0.177020058, -0.123914041, -0.10473983, -0.115317881, -0.170722514, -0.293505758, -0.346454024};
float slowZy[144] = {-9.89416695, -9.99191666, -9.94934177, -9.93153954, -9.92207718, -9.89745426, -9.85621834, -9.8363533, -9.82244682, -9.83671284, -9.84969902, -9.86478901, -9.84835243, -9.83084679, -9.83059311, -9.83041477, -9.80629063, -9.79540348, -9.78778267, -9.77644825, -9.73851395, -9.75395966, -9.79177189, -9.8122406, -9.79356861, -9.70249748, -9.74374866, -9.82962418, -9.81473732, -9.75931644, -9.67552185, -9.65586472, -9.68110561, -9.78877354, -9.79814148, -9.75969887, -9.7387886, -9.61315155, -9.69020653, -9.72014427, -9.85810089, -9.95167065, -9.94216919, -10.0075188, -9.93026352, -9.86418438, -9.69492912, -9.49245071, -9.4107151, -9.25750065, -9.14125061, -9.11087513, -9.14361286, -9.2205286, -9.27737045, -9.25715923, -9.34801197, -9.34860802, -9.36402512, -9.38081741, -9.27857208, -9.18300056, -9.20910072, -9.26337051, -9.23235893, -9.2646513, -9.35925579, -9.3414793, -9.36803532, -9.41962433, -9.43773651, -9.38441563, -9.38609123, -9.49526405, -9.61668491, -9.71967983, -9.87577629, -9.89204311, -9.71442986, -9.49110126, -9.58677101, -9.77973938, -9.7138176, -9.53567219, -9.52797031, -9.62757874, -9.58330536, -9.60631371, -9.72141933, -9.60699368, -9.54189587, -9.58032703, -9.63722897, -9.47006035, -9.40104198, -9.46672916, -9.49771023, -9.46839714, -9.72387791, -10.0587149, -10.3231001, -10.3701696, -10.2801189, -10.1450834, -10.1525583, -10.1817913, -10.2292538, -10.1574774, -9.96323395, -9.8332634, -9.6972847, -9.5600996, -9.41606998, -9.31824875, -9.24377441, -9.18264198, -9.12184906, -9.20229435, -9.27060604, -9.28242397, -9.35669708, -9.38168812, -9.32418156, -9.34992695, -9.37994862, -9.43696404, -9.40187454, -9.33531189, -9.24671841, -9.17570305, -9.23699188, -9.30989456, -9.32492638, -9.2754488, -9.18981361, -9.13286972, -9.18600845, -9.17220592, -9.20154381, -9.25208092, -9.38045692, -9.52132034, -9.58992386, -9.625947};
float slowZz[144] = {1.74233317, 1.75363326, 1.75554323, 1.7598803, 1.83491623, 1.77944136, 1.73460889, 1.66122627, 1.61285841, 1.64800084, 1.64860058, 1.68502045, 1.70451427, 1.64916003, 1.65541196, 1.64778841, 1.6454519, 1.67381632, 1.61867142, 1.63107002, 1.69374907, 1.79162431, 1.86913705, 1.86039591, 1.91427708, 1.95199394, 1.90039575, 1.87927699, 1.92749393, 1.92824578, 1.898772, 1.88414037, 1.80489826, 1.74942875, 1.74060011, 1.78542006, 1.828794, 1.86815584, 1.81170905, 1.71219635, 1.60653746, 1.62257624, 1.71180332, 1.79226232, 1.92958367, 2.10970855, 2.20279598, 2.2319572, 2.31237006, 2.25165892, 2.1971612, 2.08401275, 1.96280885, 1.87796617, 1.81557631, 1.84390342, 1.78873241, 1.7741127, 1.7578789, 1.80051517, 1.78236067, 1.81165242, 1.87715673, 1.89600968, 1.92420673, 1.84794474, 1.89656126, 1.89459288, 1.86921501, 1.97745049, 2.0922153, 2.16055059, 2.17538548, 2.22476983, 2.34933901, 2.48753738, 2.56027627, 2.63219333, 2.72753525, 2.83027458, 2.98019218, 3.1181345, 3.19969416, 3.24478579, 3.30035019, 3.27924514, 3.18947172, 3.12663031, 3.12464118, 3.13824892, 3.23177433, 3.36024213, 3.36316943, 3.39521861, 3.54665303, 3.63165712, 3.65815997, 3.64071202, 3.54149842, 3.51104879, 3.39673424, 3.34971404, 3.40379977, 3.42065978, 3.50746179, 3.5292232, 3.50845623, 3.55391932, 3.66074347, 3.7745204, 3.81216431, 3.763515, 3.78946042, 3.70862222, 3.65803552, 3.65262485, 3.75683737, 3.79978609, 3.82085013, 3.78459501, 3.63921642, 3.49845147, 3.48091602, 3.42664123, 3.43964887, 3.50875425, 3.55412793, 3.5888896, 3.59222269, 3.57355595, 3.61448908, 3.58014226, 3.6160996, 3.53026962, 3.59618878, 3.67533207, 3.68873239, 3.68911266, 3.6293788, 3.57256508, 3.57479548, 3.54635692, 3.56544971, 3.76181483};

// Normal Z
float normalZx[91] = {-1.602, -1.41540003, -1.47977996, -1.74684596, -2.07779217, -2.45345449, -2.77641821, -3.0414927, -3.24204493, -3.43043137, -3.58630204, -3.65941143, -3.65358806, -3.55651164, -3.39855814, -3.12299061, -2.79809332, -2.37866521, -1.93206561, -1.58644593, -1.19751215, -0.724258482, -0.0989809334, 0.689713359, 1.44279933, 2.15595961, 2.78117156, 3.43781996, 4.11647415, 4.38153172, 4.50707245, 4.3879509, 4.09156561, 3.63209581, 3.07346702, 2.6104269, 2.33129883, 2.26490927, 2.17943645, 2.09560561, 1.94992387, 1.72794676, 1.62356269, 1.61349392, 1.33944571, 1.08461201, 1.04422843, 0.757959902, 0.266571939, -0.272399634, -0.598679721, -0.689075828, -0.698353112, -0.722847164, -0.850993037, -1.19869518, -1.2380867, -1.12466073, -1.4442625, -2.09098363, -2.72968841, -3.20078182, -3.5185473, -4.00198317, -4.5983882, -5.0608716, -5.37861013, -5.48402691, -5.35381889, -5.00767326, -4.45037127, -3.88925982, -3.3614819, -2.80003738, -2.16402626, -1.58081841, -1.33457291, -1.27320099, -1.2122407, -0.923568487, -0.607497931, -0.143248558, 0.445726037, 1.1190083, 1.6413058, 1.94691408, 1.98383987, 1.84168792, 1.61018157, 1.30112708, 1.05478895};
float normalZy[91] = {-9.96033287, -9.90623283, -9.92236328, -9.96965408, -10.1767578, -10.2527304, -10.2759113, -10.2351379, -10.1315966, -10.0921173, -10.1094818, -10.0916376, -10.1181469, -10.0527029, -9.83889198, -9.72822475, -9.62975693, -9.52482986, -9.52038097, -9.65826607, -9.83278656, -10.0239506, -10.0197659, -9.8338356, -9.45768452, -9.12837887, -8.88886547, -8.67320633, -8.25524426, -8.03167152, -7.91417027, -7.88291931, -7.96304321, -8.00413036, -8.32689095, -8.57382393, -8.5156765, -8.34597397, -8.34718227, -8.35702801, -8.3249197, -8.2994442, -8.32661057, -8.33962727, -8.57073879, -8.72051716, -8.88536263, -9.29775429, -9.87742805, -10.3941994, -10.7829399, -10.7790585, -10.7433405, -10.5953388, -10.5367374, -10.6997166, -10.8588018, -10.7301617, -10.7361135, -10.8602791, -11.1241951, -11.1709366, -11.0656557, -11.1119595, -11.2193718, -11.2615604, -11.2400923, -11.0330648, -10.7591457, -10.3094025, -9.8985815, -9.65900707, -9.58730507, -9.74111366, -9.59978008, -9.44084549, -9.44959164, -9.61471367, -9.62229919, -9.68160915, -9.60312653, -9.32918835, -9.09543228, -9.04580307, -9.15206242, -9.33444405, -9.62111092, -9.89077759, -10.1125441, -10.2467813, -10.2267475};
float normalZz[91] = {-0.930999994, -0.909699976, -0.900789976, -0.93355298, -0.881487072, -0.908040941, -0.815628648, -0.729940057, -0.627958059, -0.574570656, -0.588199437, -0.690739632, -0.792517722, -0.89376241, -0.883633673, -0.876543581, -0.865580499, -0.845906377, -0.727134466, -0.619994104, -0.472995877, -0.337097108, -0.18496798, -0.162477583, -0.0027343065, 0.27708599, 0.490960181, 0.613672137, 0.906570494, 1.2105993, 1.37841952, 1.31289363, 1.25502551, 1.01351786, 0.643462479, 0.360423744, 0.162296623, 0.0506076366, -0.0665746555, -0.043602258, 0.212478414, 0.460734874, 0.511514425, 0.457060099, 0.613942087, 0.846759439, 1.02473164, 1.15231216, 1.19961846, 1.12773287, 0.960412979, 0.708289087, 0.534802377, 0.446361661, 0.735453129, 0.913817227, 0.894672036, 1.04327047, 1.17128932, 1.19190252, 1.03833175, 0.672832251, 0.557982564, 0.552587807, 0.764811456, 0.89536804, 0.983757615, 1.15663028, 1.25964117, 1.43974876, 1.48482418, 1.45337689, 1.53336382, 1.78435469, 2.05604839, 2.1922338, 2.12556362, 1.86289454, 1.62202621, 1.45341837, 1.6173929, 2.03817511, 2.28472257, 2.28330588, 2.40831423, 2.55281997, 2.56097388, 2.50368166, 2.49657726, 2.47960401, 2.60872293};

// Fast Z
float fastZx[34] = {-4.132833, -3.00698304, -2.63888812, -3.89322186, -6.25625563, -9.16737938, -11.4391651, -12.0064154, -10.7774906, -8.55224323, -5.6085701, -1.96699905, 2.5501008, 6.69607067, 10.3242493, 12.9479742, 14.3375816, 14.2753067, 12.4677143, 9.27939987, 4.90558004, 0.475906134, -4.0318656, -8.71730614, -11.5561142, -12.3552799, -12.1106958, -10.9104872, -8.77434063, -5.51203823, -1.18842685, 3.08910108, 6.11937046, 7.60155964};
float fastZy[34] = {-10.4506674, -10.1024675, -10.0327272, -10.2929087, -10.7750359, -11.6705256, -12.1653681, -11.4947577, -10.6473303, -9.56813145, -8.28469181, -7.08028412, -5.39719868, -3.67003918, -1.72002745, -0.406019181, 0.666786611, 0.973750651, -0.527374625, -2.83816218, -6.31871319, -9.39709949, -12.2089701, -14.3782787, -15.0987949, -14.4931564, -13.6672096, -12.6960468, -11.4432325, -9.7112627, -8.41788387, -8.1965189, -8.62056351, -9.22939396};
float fastZz[34] = {-0.120999992, -0.414700001, -0.797290027, -0.594103038, 0.0101278601, 0.100089505, -0.325937361, -1.30815613, -2.91670942, -3.75469661, -2.70028758, -0.798201263, 2.09025908, 5.14718151, 6.07502699, 6.61051893, 6.72736311, 6.51515436, 5.95860815, 5.48502588, 4.29251814, 2.8067627, 1.96773386, 1.31741369, -0.0948104486, -1.31436729, -2.35105705, -3.45474005, -3.83131814, -2.39392281, 0.628253996, 4.12077808, 6.79654455, 8.00358105};

float min(float a, float b) {
	return a < b ? a : b;
}

float max(float a, float b) {
	return a > b ? a : b;
}

float minArray(float *array, int begin, int end) {
	float min = array[begin];
	for (int i = begin + 1; i < end; i++) {
		if(array[i] < min) { min = array[i]; }
	}
	return min;
}

float maxArray(float *array, int begin, int end) {
	double max = array[begin];
	for (int i = begin + 1; i < end; i++) {
		if(array[i] > max) { max = array[i]; }
	}
	return max;
}

float average(float *array, int begin, int end) {
	float sum = 0;
	int i;
	for(i = begin; i < end; i++) {
		sum += array[i];
	}
	return sum / (float) end - begin;
}

void ewma(float *array, int size, float *result) {

	int s = size < 6 ? size : 6;
	float forecasted = average(array, 0, s);
	float smoothed = 0;

	int i;

	for (i = 1; i <= size; i++) {
		smoothed = EWMA_ALPHA * array[i - 1] + (1.0 - EWMA_ALPHA) * forecasted;
		forecasted = smoothed;
		result[i - 1] = smoothed;
	}

}

double dtwDistance1(float *ax, float *ay, float *az, int sa, float *bx, float *by, float *bz, int sb, int window) {

//	float acc[sb][sa];
//	float dist;
//
//    acc[0][0] = pow(ax[0] - bx[0], 2.0) + pow(ay[0] - by[0], 2.0) + pow(az[0] - bz[0], 2.0);
//
//    // Accumulated distance - Row 0
//    for (int i = 1; i < sa; i++) {
//        dist = pow(ax[i] - bx[0], 2.0) + pow(ay[i] - by[0], 2.0) + pow(az[i] - bz[0], 2.0);
//        acc[0][i] = acc[0][i - 1] + dist;
//    }
//
//    // Accumulated distance - Row 0
//    for (int i = 1; i < sb; i++) {
//        dist = pow(ax[0] - bx[i], 2.0) + pow(ay[0] - by[i], 2.0) + pow(az[0] - bz[i], 2.0);
//        acc[i][0] = acc[i - 1][0] + dist;
//    }
//
//    // Accumlated distance - Remaining
//    float m;
//    for (int i = 1; i < sb; i++) {
//        for (int j = 1; j < sa; j++) {
//            dist = pow(ax[j] - bx[i], 2.0) + pow(ay[j] - by[i], 2.0) + pow(az[j] - bz[i], 2.0);
//            m = min(min(acc[i - 1][j - 1],
//                    acc[i - 1][j]),
//                    acc[i][j - 1]);
//            acc[i][j] = m + dist;
//        }
//    }
//
//    return sqrt(acc[sb - 1][sa - 1]);

    return 0;

}

float dtwDistance(float *ax, float *ay, float *az, int sa, float *bx, float *by, float *bz, int sb, int window) {

	float acc[sa][sb];
	float dist;
	int maxi, mini;
	window = max(window, abs(sa - sb));

	// Temp
	for (int i = 0; i < sa; i++) {
		for (int j = 0; j < sb; j++) {
			acc[i][j] = INFINITY;
		}
	}

	acc[0][0] = pow(ax[0] - bx[0], 2.0) + pow(ay[0] - by[0], 2.0) + pow(az[0] - bz[0], 2.0);

	// Row 0
	mini = min(window, sb);
	for (int i = 1; i < mini; i++) {
		dist = pow(ax[0] - bx[i], 2.0) + pow(ay[0] - by[i], 2.0) + pow(az[0] - bz[i], 2.0);
		acc[0][i] = acc[0][i - 1] + dist;
	}

	// Column 0
	mini = min(window, sa);
	for (int i = 1; i < mini + 1; i++) {
		dist = pow(ax[i] - bx[0], 2.0) + pow(ay[i] - by[0], 2.0) + pow(az[i] - bz[0], 2.0);
		acc[i][0] = acc[i - 1][0] + dist;
	}

	// Accumlated distance - Remaining
	float m;
	for (int i = 1; i < sa; i++) {
		mini = max(1, i - window);
		maxi = min(sb, i + window);
		for (int j = mini; j < maxi; j++) {
			dist = pow(ax[i] - bx[j], 2.0) + pow(ay[i] - by[j], 2.0) + pow(az[i] - bz[j], 2.0);
			m = min(
					min(acc[i - 1][j],
							acc[i][j - 1]),
							acc[i - 1][j - 1]);
			acc[i][j] = m + dist;
		}
	}

	return sqrt(acc[sa - 1][sb - 1]);

}

float LBKeogh(float *x, int sx, float *y, int sy, int r) {

	double sum = 0;
	int li, mi;
	double lowerBound, upperBound;

	for (int i = 0; i < sx; i++) {

		li = (i - r) >= 0 ? (i - r) : 0;
		mi = (i + r) <= sy ? (i + r) : sy;

		lowerBound = minArray(y, li, mi);
		upperBound = maxArray(y, li, mi);

		if(x[i] > upperBound) {
			sum += pow(x[i] - upperBound, 2);
		} else if(x[i] < lowerBound) {
			sum += pow(x[i] - lowerBound, 2);
		}

	}

	return sqrt(sum);
}

float LBKeogh3D(float *ax, float *ay, float *az, int sa, float *bx, float *by, float *bz, int sb, int r) {
	float lx = LBKeogh(ax, sa, bx, sb, r);
	float ly = LBKeogh(ay, sa, by, sb, r);
	float lz = LBKeogh(az, sa, bz, sb, r);
	return lx + ly + lz;
}

int knn(float inputX[], float inputY[], float inputZ[], int size) {

	int answer;
	float distance = INFINITY;
	float minDistance = INFINITY;
	int lbr = 30;

	float* pointersX[NUMBER_OF_GESTURES] = {normalOx, fastOx, normalZx, fastZx};
	float* pointersY[NUMBER_OF_GESTURES] = {normalOy, fastOy, normalZy, fastZy};
	float* pointersZ[NUMBER_OF_GESTURES] = {normalOz, fastOz, normalZz, fastZz};

	int sizes[NUMBER_OF_GESTURES] = {100, 35, 91, 34};
	int window = 30;

	for(int i = 0; i < NUMBER_OF_GESTURES; i++) {
		if(LBKeogh3D(inputX, inputY, inputZ, size, pointersX[i], pointersY[i], pointersZ[i], sizes[i], lbr) < minDistance) {
			distance = dtwDistance(inputX, inputY, inputZ, size, pointersX[i], pointersY[i], pointersZ[i], sizes[i], window);
			if(distance < minDistance) {
				minDistance = distance;
				answer = i;
			}
		}
	}

	if(minDistance != minDistance) { //Nan
		return minDistance;
	}

	// Negative if the distance is infinity
	return answer * (minDistance == INFINITY ? -1 : 1);

}
